import os

# å°è¯•å¯¼å…¥ python-docxï¼Œå¦‚æœæ²¡æœ‰åˆ™æç¤ºå®‰è£…
try:
    from docx import Document
    from docx.shared import Pt
    from docx.enum.text import WD_PARAGRAPH_ALIGNMENT
except ImportError:
    print("æ­£åœ¨å®‰è£… python-docx åº“...")
    os.system("pip install python-docx")
    from docx import Document
    from docx.shared import Pt
    from docx.enum.text import WD_PARAGRAPH_ALIGNMENT

# åˆ›å»ºè¾“å‡ºç›®å½•
output_dir = "RAG_Test_Data"
if not os.path.exists(output_dir):
    os.makedirs(output_dir)

# ==========================================
# 1. ç”Ÿæˆ TXT æ–‡ä»¶ (æ³•åŠ¡/åè®®ç±»)
# ==========================================
txt_content = """ç”µå•†å¹³å°å”®åæœåŠ¡åè®®æ¡æ¬¾ï¼ˆ2025ä¿®è®¢ç‰ˆï¼‰

ç¬¬ä¸€æ¡ æœ¯è¯­å®šä¹‰
1.1 "ä¸ƒå¤©æ— ç†ç”±é€€è´§"æ˜¯æŒ‡æ¶ˆè´¹è€…åœ¨ç­¾æ”¶å•†å“ä¹‹æ—¥èµ·ä¸ƒæ—¥å†…ï¼ˆå«ä¸ƒæ—¥ï¼‰ï¼Œåœ¨ä¿è¯å•†å“å®Œå¥½ã€ä¸å½±å“äºŒæ¬¡é”€å”®çš„å‰æä¸‹ï¼Œå¯ä»¥ç”³è¯·æ— ç†ç”±é€€è´§ã€‚
1.2 "ç­¾æ”¶æ—¥"ä»¥ç‰©æµè¯¦æƒ…é¡µæ˜¾ç¤ºçš„"ç­¾æ”¶"ã€"ä»£æ”¶"æ—¶é—´æ¬¡æ—¥é›¶ç‚¹å¼€å§‹è®¡ç®—ã€‚
1.3 "è€—æç±»å•†å“"æŒ‡åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ä¼šäº§ç”Ÿè‡ªç„¶æ¶ˆè€—ã€æ— æ³•å¤åŸçš„å•†å“ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºå¢¨ç›’ã€èƒ¶å·ã€æŠ¤è‚¤å“è¯•ç”¨è£…ç­‰ã€‚

ç¬¬äºŒæ¡ è´£ä»»é™åˆ¶
2.1 å› ç”¨æˆ·ä½¿ç”¨ä¸å½“ï¼ˆåŒ…æ‹¬ä½†ä¸é™äºæ‘”è½ã€è¿›æ¶²ã€æ“…è‡ªæ‹†æœºã€åˆ·æœºï¼‰å¯¼è‡´çš„å•†å“æŸåï¼Œä¸å±äºè´¨é‡é—®é¢˜èŒƒå›´ï¼Œå¹³å°ä¸æ‰¿æ‹…é€€æ¢è´§ä¹‰åŠ¡ã€‚
2.2 å¯¹äºè·¨å¢ƒæµ·å¤–è´­å•†å“ï¼Œç”±äºæµ·å…³ç¨è´¹åŠå›½é™…ç‰©æµæˆæœ¬ï¼Œé™¤å•†å“æœ¬èº«å­˜åœ¨ä¸¥é‡è´¨é‡ç¼ºé™·å¤–ï¼ŒåŸåˆ™ä¸Šä¸æ”¯æŒæ— ç†ç”±é€€è´§ã€‚è‹¥å¼ºè¡Œé€€è´§ï¼Œç”¨æˆ·éœ€æ‰¿æ‹…å›½é™…æ®µå¾€è¿”è¿è´¹åŠå¯èƒ½äº§ç”Ÿçš„å…³ç¨ã€‚

ç¬¬ä¸‰æ¡ é€€æ¬¾è¯´æ˜
3.1 åŸè·¯é€€å›ï¼šæ‰€æœ‰é€€æ¬¾å°†ä¾ç…§åŸæ”¯ä»˜è·¯å¾„é€€å›ã€‚ä¿¡ç”¨å¡æ”¯ä»˜ä¸€èˆ¬éœ€è¦3-7ä¸ªé“¶è¡Œå·¥ä½œæ—¥åˆ°è´¦ã€‚
3.2 ç§¯åˆ†ä¸ä¼˜æƒ åˆ¸ï¼šè®¢å•å‘ç”Ÿéƒ¨åˆ†é€€æ¬¾æ—¶ï¼Œä¼˜å…ˆé€€è¿˜ç°é‡‘éƒ¨åˆ†ï¼Œç§¯åˆ†ä¸ä¼˜æƒ åˆ¸æŒ‰æ¯”ä¾‹æŠ˜ç®—ï¼Œè‹¥ä¼˜æƒ åˆ¸å·²è¿‡æœŸåˆ™ä¸äºˆè¡¥å‘ã€‚
"""

with open(f"{output_dir}/01_å¹³å°å”®åæœåŠ¡åè®®_æ³•åŠ¡ç‰ˆ.txt", "w", encoding="utf-8") as f:
    f.write(txt_content)
print(f"âœ… TXT æ–‡ä»¶å·²ç”Ÿæˆ: {output_dir}/01_å¹³å°å”®åæœåŠ¡åè®®_æ³•åŠ¡ç‰ˆ.txt")


# ==========================================
# 2. ç”Ÿæˆ MD æ–‡ä»¶ (ç”¨æˆ·æŒ‡å—/Wikiç±»)
# ==========================================
md_content = """# ç”¨æˆ·å¸®åŠ©ä¸­å¿ƒ - é€€æ¢è´§æŒ‡å—

## ğŸŒŸ æ ¸å¿ƒæ”¿ç­–å¿«è¯»
* **ä¸æ»¡æ„ï¼Ÿ** 7å¤©å†…éšä¾¿é€€ï¼ˆåªè¦æ²¡åï¼‰ã€‚
* **åäº†ï¼Ÿ** 15å¤©å†…åŒ…æ¢ï¼Œ1å¹´å†…ä¿ä¿®ã€‚
* **å‘è´§æ…¢ï¼Ÿ** è¶…è¿‡48å°æ—¶æœªå‘è´§ï¼Œè‡ªåŠ¨èµ”ä»˜ 5% è¿çº¦é‡‘ã€‚

## ğŸ’° å…³äºè¿è´¹ï¼ˆè°æ¥å‡ºé’±ï¼Ÿï¼‰
å¾ˆå¤šç”¨æˆ·å…³å¿ƒè¿è´¹é—®é¢˜ï¼Œæˆ‘ä»¬åˆ¶å®šäº†ä»¥ä¸‹ç®€æ˜è§„åˆ™ï¼š

| åœºæ™¯ | è°å‡ºè¿è´¹ï¼Ÿ | å¤‡æ³¨ |
| :--- | :--- | :--- |
| å•†å“æœ‰è´¨é‡é—®é¢˜ | **å•†å®¶æ‰¿æ‹…** | éœ€æä¾›ç…§ç‰‡/è§†é¢‘å‡­è¯ |
| ä¸å–œæ¬¢/æ‹é”™äº† | **ç”¨æˆ·æ‰¿æ‹…** | éœ€ä¿æŒåŒ…è£…å®Œæ•´ |
| æ‹’æ”¶å¿«é€’ | **ç”¨æˆ·æ‰¿æ‹…** | å°†æ‰£é™¤åŒç¨‹è¿è´¹ |
| å•†å®¶å‘é”™è´§ | **å•†å®¶æ‰¿æ‹…** | è¯·å‹¿æ‹†å°åŸåŒ…è£… |

## âš ï¸ ç‰¹æ®Šå•†å“ä¸æ”¯æŒé€€è´§åˆ—è¡¨
> è¯·æ³¨æ„ï¼Œä»¥ä¸‹å•†å“ä¸€ç»å”®å‡ºï¼Œé™¤éè´¨é‡é—®é¢˜ï¼Œå¦åˆ™æ— æ³•é€€æ¢ï¼š
1.  **è´´èº«è¡£ç‰©**ï¼šå†…è£¤ã€æ–‡èƒ¸ã€ä¿æš–å†…è¡£ï¼ˆä¸ºäº†å¤§å®¶çš„å«ç”Ÿå®‰å…¨ï¼‰ã€‚
2.  **ç”Ÿé²œé£Ÿå“**ï¼šè½¦å˜å­ã€æµ·é²œç­‰çŸ­ä¿è´¨æœŸå•†å“ã€‚
3.  **è™šæ‹Ÿå•†å“**ï¼šå·²å‘è´§çš„æ¸¸æˆæ¿€æ´»ç ã€ä¼šå‘˜å……å€¼ã€‚

## ğŸ“¦ å¦‚ä½•å¯„å›å•†å“ï¼Ÿ
1.  è¿›å…¥"æˆ‘çš„è®¢å•" -> ç‚¹å‡»"ç”³è¯·å”®å"ã€‚
2.  å®¡æ ¸é€šè¿‡åï¼Œç³»ç»Ÿä¼šæä¾›é€€è´§åœ°å€ã€‚
3.  è¯·åœ¨åŒ…è£¹å†…é™„ä¸Šä¸€å¼ çº¸æ¡ï¼Œå†™æ˜ï¼š**è®¢å•å·ã€è”ç³»äººç”µè¯ã€é€€è´§åŸå› **ã€‚
"""

with open(f"{output_dir}/02_ç”¨æˆ·å¸®åŠ©ä¸­å¿ƒ_å¸¸è§é—®é¢˜.md", "w", encoding="utf-8") as f:
    f.write(md_content)
print(f"âœ… Markdown æ–‡ä»¶å·²ç”Ÿæˆ: {output_dir}/02_ç”¨æˆ·å¸®åŠ©ä¸­å¿ƒ_å¸¸è§é—®é¢˜.md")


# ==========================================
# 3. ç”Ÿæˆ DOCX æ–‡ä»¶ (å†…éƒ¨SOP/è¡¨æ ¼ç±»)
# ==========================================
doc = Document()
doc.add_heading('å®¢æœå†…éƒ¨å”®åå¤„ç†æ ‡å‡†æµç¨‹ (SOP)', 0)
doc.add_paragraph('å¯†çº§ï¼šä»…é™å†…éƒ¨ä¼ é˜…', style='Subtitle')

# ç« èŠ‚ 1
doc.add_heading('ç¬¬ä¸€ç« ï¼šç‰¹æ®Šæƒé™å®¡æ‰¹', level=1)
p = doc.add_paragraph()
p.add_run('1. é‡åˆ°å¼ºåŠ›æŠ•è¯‰ç”¨æˆ·ï¼ˆæƒ…ç»ªæ¿€åŠ¨ç­‰çº§ > 3çº§ï¼‰ï¼š').bold = True
doc.add_paragraph('   - ä¸€çº¿å®¢æœå¯ç”³è¯· 20å…ƒ æ— é—¨æ§›ä¼˜æƒ åˆ¸ä½œä¸ºå®‰æŠšã€‚')
doc.add_paragraph('   - è‹¥ç”¨æˆ·åšæŒé€€è´§ä½†å·²è¿‡7å¤©ï¼ˆ7-15å¤©å†…ï¼‰ï¼š')
doc.add_paragraph('     - é“¶ç‰Œä»¥ä¸Šä¼šå‘˜ï¼šä¸»ç®¡å¯ç‰¹æ‰¹"ä¾‹å¤–é€€è´§"ï¼Œä½†éœ€ç”±ç”¨æˆ·æ‰¿æ‹…è¿è´¹ã€‚')
doc.add_paragraph('     - æ™®é€šç”¨æˆ·ï¼šä¸¥æ ¼æ‰§è¡Œæ‹’ç»ç­–ç•¥ï¼Œä½†å¯èµ é€ç§¯åˆ†ã€‚')

p = doc.add_paragraph()
p.add_run('2. æ‹†å°åé€€è´§çš„ç‰¹æ®Šå¤„ç†ï¼š').bold = True
doc.add_paragraph('   - æ•°ç äº§å“ï¼ˆå·²å¼€æœºï¼‰ï¼šåŸåˆ™ä¸Šæ‹’ç»ã€‚ä½†å¦‚æœç”¨æˆ·æ˜¯ V5 é’»çŸ³ä¼šå‘˜ï¼Œä¸”æ¯å¹´é€€è´§ç‡ < 10%ï¼Œå¯ç”³è¯·"æŠ˜æ—§é€€è´§"ï¼Œæ‰£é™¤ 15% æŠ˜æ—§è´¹åé€€æ¬¾ã€‚')

# ç« èŠ‚ 2
doc.add_heading('ç¬¬äºŒç« ï¼šæ¶æ„é€€è´§è¯†åˆ«ï¼ˆé£æ§ï¼‰', level=1)
doc.add_paragraph('è‹¥ç³»ç»Ÿæç¤º"é«˜é£é™©ç”¨æˆ·"æˆ–è¯¥ç”¨æˆ·åŒIDä¸‹æœ€è¿‘ä¸€ä¸ªæœˆé€€è´§è¶…è¿‡ 5 å•ï¼š')
doc.add_paragraph('1. å¿…é¡»è¦æ±‚ç”¨æˆ·å…ˆå¯„å›å•†å“ï¼Œä»“åº“è¿›è¡Œè§†é¢‘æ‹†åŒ…éªŒè´§ã€‚', style='List Number')
doc.add_paragraph('2. ä¸¥ç¦ä½¿ç”¨"æé€Ÿé€€æ¬¾"åŠŸèƒ½ã€‚', style='List Number')
doc.add_paragraph('3. è‹¥å‘ç°å•†å“è¢«è°ƒåŒ…ï¼Œç›´æ¥æŠ¥è­¦å¹¶å°ç¦è´¦å·ã€‚', style='List Number')

# ç« èŠ‚ 3
doc.add_heading('ç¬¬ä¸‰ç« ï¼šå¤§ä¿ƒæœŸé—´ï¼ˆåŒ11/618ï¼‰ä¸´æ—¶è°ƒæ•´', level=1)
doc.add_paragraph('ç”±äºç‰©æµå‹åŠ›ï¼Œå¤§ä¿ƒæœŸé—´"æœªæ”¶åˆ°è´§"çš„ä»…é€€æ¬¾ç”³è¯·ï¼Œç­‰å¾…æœŸç”± 3 å¤©å»¶é•¿è‡³ 7 å¤©ã€‚è¯·ç»Ÿä¸€è¯æœ¯å›å¤ç”¨æˆ·ï¼š"å› å¤§ä¿ƒç‰©æµç§¯å‹ï¼Œè¯·æ‚¨è€å¿ƒç­‰å¾…ã€‚"')

doc_path = f"{output_dir}/03_å®¢æœå†…éƒ¨æ‰§è¡Œæ‰‹å†Œ_SOP.docx"
doc.save(doc_path)
print(f"âœ… Word æ–‡ä»¶å·²ç”Ÿæˆ: {doc_path}")

print("\nğŸ‰ æ‰€æœ‰æµ‹è¯•æ–‡ä»¶å·²ç”Ÿæˆå®Œæ¯•ï¼Œè¯·æŸ¥çœ‹ RAG_Test_Data æ–‡ä»¶å¤¹ï¼")